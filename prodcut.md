# 猫咪前世预测应用 - 产品规格文档

## 📋 项目概述

### 项目名称
**喵星人前世探秘器** (Miao Past Life Predictor)

### 项目描述
一个基于AI的趣味应用，通过分析用户上传的猫咪照片和基本信息，利用大模型推理生成该猫咪对应的人类前世形象、故事背景和性格设定。为猫奴们提供一个充满想象力和娱乐性的互动体验。

### 目标用户
- 猫咪爱好者和宠物主人
- 喜欢AI创意内容的用户
- 寻求娱乐和趣味体验的年轻用户群体

---

## 🎯 核心功能

### 1. 主要功能
- **猫咪信息收集**: 用户上传猫咪照片并填写基础信息问卷
- **AI前世预测**: 基于Dify大模型生成猫咪的人类前世形象
- **结果展示**: 精美展示前世故事、人物形象和性格特征
- **社交分享**: 支持将预测结果分享到社交平台

### 2. 技术特色
- 集成Dify AI大模型API
- 智能图像分析和文本生成
- 响应式Web设计
- 快速部署和扩展

---

## 🔄 用户操作流程

### 页面1: 信息收集页面
```
用户进入应用 → 上传猫咪照片 → 填写问卷 → 点击"预测前世" → 等待AI生成
```

#### 1.1 猫咪照片上传
- **功能**: 支持拖拽或点击上传
- **格式**: JPG, PNG, WEBP (最大5MB)
- **预览**: 实时显示上传的照片
- **验证**: 自动检测是否为猫咪照片

#### 1.2 猫咪信息问卷
**必填信息:**
- 猫咪姓名
- 性别 (公猫/母猫/未知)
- 年龄 (幼猫/成猫/老猫)
- 品种 (下拉选择 + 自定义输入)

**选填信息:**
- 生日/领养日期
- 性格特征 (多选: 活泼/安静/粘人/独立/调皮/温顺)
- 喜好习惯 (多选: 晒太阳/玩玩具/睡觉/吃零食/看窗外)
- 特殊技能 (开门/握手/装死/其他)

#### 1.3 预测触发
- **按钮**: "探索它的前世" 
- **加载状态**: 显示AI分析进度和趣味文案
- **预计时间**: 30-60秒

### 页面2: 结果展示页面
```
AI生成完成 → 自动跳转结果页 → 展示前世信息 → 支持分享和重新预测
```

#### 2.1 前世人物形象
- **AI生成肖像**: 基于猫咪特征生成的人类形象
- **基本信息**: 姓名、年代、职业、身份
- **外貌描述**: 详细的外貌特征描述

#### 2.2 前世故事背景
- **时代背景**: 历史时期和地理位置
- **生活故事**: 500-800字的前世生活故事
- **性格特征**: 与现在猫咪性格的对应关系
- **有趣细节**: 前世的特殊经历或技能

#### 2.3 互动功能
- **重新预测**: 返回第一页重新开始
- **分享结果**: 生成精美的分享卡片
- **保存图片**: 下载结果图片到本地

---

## 🛠 技术架构

### 前端技术栈
- **框架**: 原生HTML5 + CSS3 + JavaScript (与现有项目保持一致)
- **UI库**: 自定义CSS + 动画效果
- **图片处理**: Canvas API进行图片压缩和预处理
- **状态管理**: LocalStorage存储用户数据

### 后端集成
- **AI服务**: Dify大模型API
- **图片存储**: 临时存储用户上传的图片
- **数据处理**: 前端直接调用Dify API

### API设计

#### Dify集成接口
```javascript
// API调用示例
const predictPastLife = async (catData) => {
  const payload = {
    inputs: {
      cat_name: catData.name,
      cat_gender: catData.gender,
      cat_age: catData.age,
      cat_breed: catData.breed,
      cat_personality: catData.personality.join(','),
      cat_habits: catData.habits.join(','),
      cat_image_description: catData.imageAnalysis
    },
    response_mode: "streaming",
    user: "user_" + Date.now()
  };
  
  const response = await fetch('https://api.dify.ai/v1/workflows/run', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer YOUR_API_KEY',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(payload)
  });
  
  return response.json();
};
```

---

## 🎨 UI/UX设计要求

### 设计风格
- **主题色彩**: 温暖的橙色系 + 柔和的紫色系
- **设计风格**: 现代简约 + 可爱元素
- **字体**: 圆润友好的中文字体
- **图标**: 猫咪主题的可爱图标

### 页面布局

#### 页面1: 信息收集页
```
┌─────────────────────────────────────┐
│           🐱 喵星人前世探秘器          │
├─────────────────────────────────────┤
│  [上传猫咪照片区域]                    │
│  📷 点击或拖拽上传照片                 │
├─────────────────────────────────────┤
│  📝 告诉我们关于你的猫咪               │
│  ┌─ 猫咪姓名: [输入框]               │
│  ├─ 性别: [单选按钮]                │
│  ├─ 年龄: [下拉选择]                │
│  ├─ 品种: [下拉选择]                │
│  ├─ 性格: [多选标签]                │
│  └─ 喜好: [多选标签]                │
├─────────────────────────────────────┤
│         [🔮 探索我的前世]             │
└─────────────────────────────────────┘
```

#### 页面2: 结果展示页
```
┌─────────────────────────────────────┐
│      ✨ 你的猫咪的前世揭秘 ✨          │
├─────────────────────────────────────┤
│  [AI生成的人物肖像]  │  前世身份信息    │
│                     │  • 姓名: xxx   │
│                     │  • 年代: xxx   │
│                     │  • 职业: xxx   │
├─────────────────────────────────────┤
│              📖 前世故事              │
│  [详细的前世生活故事文本]              │
├─────────────────────────────────────┤
│  [🔄 重新预测] [📤 分享结果] [💾 保存]  │
└─────────────────────────────────────┘
```

### 交互设计
- **加载动画**: 猫咪主题的可爱加载动画
- **过渡效果**: 平滑的页面切换动画
- **反馈提示**: 友好的成功/错误提示信息
- **响应式**: 适配手机、平板、桌面端

---

## 📊 Dify工作流设计

### 输入参数
```yaml
inputs:
  cat_name: string          # 猫咪姓名
  cat_gender: string        # 性别
  cat_age: string           # 年龄段
  cat_breed: string         # 品种
  cat_personality: string   # 性格特征(逗号分隔)
  cat_habits: string        # 生活习惯(逗号分隔)
  cat_image_description: string  # 图片分析结果
```

### 处理流程
1. **信息整合节点**: 整合所有猫咪信息
2. **性格分析节点**: 基于猫咪特征分析对应人类性格
3. **时代选择节点**: 随机选择历史时期
4. **身份生成节点**: 生成前世身份和职业
5. **故事创作节点**: 编写详细的前世故事
6. **形象描述节点**: 描述前世人物外貌特征

### 输出格式
```json
{
  "past_life": {
    "name": "李清照",
    "era": "宋朝",
    "period": "1084-1155年",
    "occupation": "词人、文学家",
    "location": "山东济南",
    "appearance": {
      "description": "清秀脱俗，眉目如画...",
      "features": ["温婉", "聪慧", "优雅"]
    },
    "personality": {
      "traits": ["才华横溢", "性格独立", "情感丰富"],
      "connection_to_cat": "正如你的猫咪一样优雅而独立..."
    },
    "life_story": "在宋朝的济南，有一位名叫李清照的女子...",
    "special_skills": ["诗词创作", "书法", "收藏古玩"],
    "interesting_facts": [
      "是中国历史上最著名的女词人",
      "与丈夫赵明诚共同收藏古籍字画"
    ]
  }
}
```

---

## 🚀 开发计划

### 第一阶段: 基础功能 (1-2周)
- [x] 项目初始化和环境搭建
- [ ] 页面1: 信息收集界面开发
- [ ] 图片上传和预览功能
- [ ] 问卷表单设计和验证
- [ ] Dify API集成测试

### 第二阶段: 核心功能 (2-3周)
- [ ] 页面2: 结果展示界面开发
- [ ] AI预测流程完整实现
- [ ] 加载状态和错误处理
- [ ] 结果页面布局和样式

### 第三阶段: 优化完善 (1-2周)
- [ ] 响应式设计适配
- [ ] 性能优化和缓存机制
- [ ] 分享功能实现
- [ ] 用户体验优化

### 第四阶段: 测试部署 (1周)
- [ ] 功能测试和bug修复
- [ ] Vercel部署配置
- [ ] 生产环境测试
- [ ] 用户反馈收集

---

## 📁 文件结构

```
miao-past-life-predictor/
├── index.html                 # 主页面
├── pages/
│   ├── collect.html          # 信息收集页面
│   └── result.html           # 结果展示页面
├── assets/
│   ├── css/
│   │   ├── main.css         # 主样式文件
│   │   ├── collect.css      # 收集页样式
│   │   └── result.css       # 结果页样式
│   ├── js/
│   │   ├── main.js          # 主逻辑
│   │   ├── upload.js        # 图片上传处理
│   │   ├── dify-api.js      # Dify API集成
│   │   └── utils.js         # 工具函数
│   └── images/
│       ├── icons/           # 图标文件
│       ├── backgrounds/     # 背景图片
│       └── placeholders/    # 占位图片
├── config/
│   └── api-config.js        # API配置
├── package.json
├── vercel.json
└── README.md
```

---

## 🔧 配置说明

### 环境变量
```env
DIFY_API_KEY=your_dify_api_key_here
DIFY_WORKFLOW_ID=your_workflow_id_here
DIFY_BASE_URL=https://api.dify.ai/v1
```

### Vercel部署配置
```json
{
  "buildCommand": "echo 'Static site ready'",
  "outputDirectory": ".",
  "installCommand": "npm install",
  "env": {
    "DIFY_API_KEY": "@dify_api_key",
    "DIFY_WORKFLOW_ID": "@dify_workflow_id"
  }
}
```

---

## 📈 成功指标

### 用户体验指标
- 页面加载时间 < 3秒
- AI预测成功率 > 95%
- 用户完成率 > 80%
- 分享转化率 > 30%

### 技术指标
- API响应时间 < 30秒
- 图片上传成功率 > 98%
- 移动端适配完整度 100%
- 浏览器兼容性覆盖主流浏览器

---

## 🎉 后续扩展功能

### 高级功能
- **多猫咪对比**: 支持上传多只猫咪进行前世关系分析
- **前世配对**: 分析两只猫咪的前世是否有交集
- **时间线展示**: 展示猫咪前世的完整时间线
- **3D人物模型**: 生成3D前世人物形象

### 社交功能
- **用户画廊**: 展示所有用户的预测结果
- **点赞评论**: 支持对预测结果进行互动
- **排行榜**: 最受欢迎的前世形象排行
- **主题活动**: 定期举办前世主题活动

### 商业化功能
- **高清图片**: 付费下载高清前世肖像
- **定制故事**: 付费获得更详细的前世故事
- **实体产品**: 制作前世人物周边产品
- **会员系统**: VIP用户享受更多功能

---

## 📞 联系信息

**项目负责人**: Zeon.Xue  
**开发团队**: Miao Translator Team  
**项目仓库**: https://github.com/yourusername/miao-past-life-predictor  
**演示地址**: https://miao-past-life.vercel.app  

---

*本文档将根据开发进度和用户反馈持续更新*
